const express=require("express");require("dotenv").config();const path=require("path"),{logger:logger,logEvents:logEvents}=require("./middleware/logger"),errorHandler=require("./middleware/errorHandler"),cookieParser=require("cookie-parser"),cors=require("cors"),corsConfigs=require("./config/corsConfigs"),mongoose=require("mongoose"),connectDB=require("./config/dbConn"),credentials=require("./middleware/credentials"),app=express(),port=process.env.PORT||3500;connectDB(),app.use(logger),app.use(credentials),app.use(cors(corsConfigs)),app.use(express.json()),app.use(cookieParser()),app.use("/",express.static(path.join(__dirname,"/views"))),app.use("/",require("./routes/root")),app.use("/users",require("./routes/userRoutes")),app.use("/notes",require("./routes/noteRoutes")),app.use("/auth",require("./routes/authRoutes")),app.all("*",require("./routes/404")),app.use(errorHandler),mongoose.connection.once("open",(()=>{app.listen(port,(()=>{}))})),mongoose.connection.on("error",(e=>{logEvents(`${e.no}: ${e.code}\t${e.syscall}\t${e.hostname}\t`,"mongoDBErrLog.log")}));